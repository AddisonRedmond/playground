import { motion } from "motion/react";
import { useEffect } from "react";

const Nav: React.FC<{
  path: string;
  setPath: React.Dispatch<React.SetStateAction<string>>;
}> = ({ path, setPath }) => {
  const intital = {
    x: -160,
  };
  const hover = { x: 0 };
  const transtion = { type: "spring", stiffness: 300, damping: 35 };

  useEffect(() => {
    const handleUrlChange = () => {
      setPath(window.location.pathname);
    };

    // Listen for back/forward buttons
    window.addEventListener("popstate", handleUrlChange);

    // Patch pushState so it also triggers
    const originalPushState = history.pushState;
    history.pushState = function (...args) {
      originalPushState.apply(this, args);
      handleUrlChange();
    };

    return () => {
      window.removeEventListener("popstate", handleUrlChange);
      history.pushState = originalPushState;
    };
  }, []);

  const setUrl = (newPath: string) => {
    if (newPath !== window.location.pathname) {
      history.pushState({}, "", newPath);
      setPath(newPath);
    }
  };

  console.log(path);
  return (
    <div className="h-full w-56 ">
      <motion.div
        onClick={() => setUrl("/site-catalog")}
        animate={path === "/site-catalog" || path === "/" ? { x: 0 } : intital}
        whileHover={hover}
        // @ts-ignore
        transition={transtion}
        id="site-catalog"
        className="cursor-pointer flex justify-around items-center h-12 rounded-r-full font-medium transition-colors ease-in-out duration-150 hover:bg-purple-200"
      >
        <p className="w-24">Site Catalog</p>
        <svg
          width="15"
          height="15"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M30 15C30 18.9782 28.4196 22.7936 25.6066 25.6066C22.7936 28.4196 18.9782 30 15 30C11.0218 30 7.20644 28.4196 4.3934 25.6066C1.58035 22.7936 0 18.9782 0 15C0 11.0218 1.58035 7.20644 4.3934 4.3934C7.20644 1.58035 11.0218 0 15 0C18.9782 0 22.7936 1.58035 25.6066 4.3934C28.4196 7.20644 30 11.0218 30 15ZM15.9375 8.4375C15.9375 8.18886 15.8387 7.9504 15.6629 7.77459C15.4871 7.59877 15.2486 7.5 15 7.5C14.7514 7.5 14.5129 7.59877 14.3371 7.77459C14.1613 7.9504 14.0625 8.18886 14.0625 8.4375V14.0625H8.4375C8.18886 14.0625 7.9504 14.1613 7.77459 14.3371C7.59877 14.5129 7.5 14.7514 7.5 15C7.5 15.2486 7.59877 15.4871 7.77459 15.6629C7.9504 15.8387 8.18886 15.9375 8.4375 15.9375H14.0625V21.5625C14.0625 21.8111 14.1613 22.0496 14.3371 22.2254C14.5129 22.4012 14.7514 22.5 15 22.5C15.2486 22.5 15.4871 22.4012 15.6629 22.2254C15.8387 22.0496 15.9375 21.8111 15.9375 21.5625V15.9375H21.5625C21.8111 15.9375 22.0496 15.8387 22.2254 15.6629C22.4012 15.4871 22.5 15.2486 22.5 15C22.5 14.7514 22.4012 14.5129 22.2254 14.3371C22.0496 14.1613 21.8111 14.0625 21.5625 14.0625H15.9375V8.4375Z"
            fill="black"
          />
        </svg>
      </motion.div>
      <motion.div
        onClick={() => setUrl("/orders")}
        animate={path === "/orders" ? { x: 0 } : intital}
        whileHover={hover}
        // @ts-ignore

        transition={transtion}
        id="orders"
        className="cursor-pointer flex justify-around items-center h-12 rounded-r-full font-medium transition-colors ease-in-out duration-150 hover:bg-purple-200"
      >
        <p className="w-24">Orders</p>
        <svg
          width="15"
          height="15"
          viewBox="0 0 15 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M0 0.5C0 0.367392 0.0526801 0.240215 0.146451 0.146447C0.240222 0.0526784 0.367403 0 0.500015 0H2.00006C2.1116 3.08115e-05 2.21992 0.0373507 2.3078 0.106025C2.39569 0.174699 2.45809 0.270784 2.48508 0.379L2.89009 2H14.5004C14.5739 2.00007 14.6464 2.0163 14.7128 2.04755C14.7792 2.0788 14.838 2.12429 14.8849 2.1808C14.9317 2.23731 14.9656 2.30345 14.984 2.37452C15.0024 2.44558 15.005 2.51984 14.9915 2.592L13.4914 10.592C13.47 10.7066 13.4092 10.8101 13.3195 10.8846C13.2298 10.9591 13.117 10.9999 13.0004 11H4.00012C3.88355 10.9999 3.77068 10.9591 3.68102 10.8846C3.59137 10.8101 3.53056 10.7066 3.50911 10.592L2.01006 2.607L1.61005 1H0.500015C0.367403 1 0.240222 0.947322 0.146451 0.853553C0.0526801 0.759785 0 0.632608 0 0.5ZM3.1021 3L4.41514 10H12.5854L13.8984 3H3.1021ZM5.00015 11C4.4697 11 3.96098 11.2107 3.5859 11.5858C3.21081 11.9609 3.00009 12.4696 3.00009 13C3.00009 13.5304 3.21081 14.0391 3.5859 14.4142C3.96098 14.7893 4.4697 15 5.00015 15C5.5306 15 6.03933 14.7893 6.41441 14.4142C6.7895 14.0391 7.00022 13.5304 7.00022 13C7.00022 12.4696 6.7895 11.9609 6.41441 11.5858C6.03933 11.2107 5.5306 11 5.00015 11ZM12.0004 11C11.4699 11 10.9612 11.2107 10.5861 11.5858C10.211 11.9609 10.0003 12.4696 10.0003 13C10.0003 13.5304 10.211 14.0391 10.5861 14.4142C10.9612 14.7893 11.4699 15 12.0004 15C12.5308 15 13.0395 14.7893 13.4146 14.4142C13.7897 14.0391 14.0004 13.5304 14.0004 13C14.0004 12.4696 13.7897 11.9609 13.4146 11.5858C13.0395 11.2107 12.5308 11 12.0004 11ZM5.00015 12C5.26538 12 5.51974 12.1054 5.70728 12.2929C5.89482 12.4804 6.00019 12.7348 6.00019 13C6.00019 13.2652 5.89482 13.5196 5.70728 13.7071C5.51974 13.8946 5.26538 14 5.00015 14C4.73493 14 4.48057 13.8946 4.29303 13.7071C4.10548 13.5196 4.00012 13.2652 4.00012 13C4.00012 12.7348 4.10548 12.4804 4.29303 12.2929C4.48057 12.1054 4.73493 12 5.00015 12ZM12.0004 12C12.2656 12 12.52 12.1054 12.7075 12.2929C12.895 12.4804 13.0004 12.7348 13.0004 13C13.0004 13.2652 12.895 13.5196 12.7075 13.7071C12.52 13.8946 12.2656 14 12.0004 14C11.7351 14 11.4808 13.8946 11.2932 13.7071C11.1057 13.5196 11.0003 13.2652 11.0003 13C11.0003 12.7348 11.1057 12.4804 11.2932 12.2929C11.4808 12.1054 11.7351 12 12.0004 12Z"
            fill="black"
          />
        </svg>
      </motion.div>

      <motion.div
        onClick={() => setUrl("/recurring-supply-orders")}
        animate={path === "/recurring-supply-orders" ? { x: 0 } : intital}
        whileHover={hover}
        // @ts-ignore

        transition={transtion}
        id="recurring-supply-orders"
        className="cursor-pointer flex justify-around items-center h-12 rounded-r-full font-medium transition-colors ease-in-out duration-150 hover:bg-purple-200"
      >
        <p className="w-24 text-balance text-sm">Recurring Supply Orders</p>
        <svg
          width="15"
          height="15"
          viewBox="0 0 15 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M13.125 0H1.875C1.37772 0 0.900806 0.197544 0.549175 0.549175C0.197544 0.900806 0 1.37772 0 1.875L0 13.125C0 13.6223 0.197544 14.0992 0.549175 14.4508C0.900806 14.8025 1.37772 15 1.875 15H13.125C13.6223 15 14.0992 14.8025 14.4508 14.4508C14.8025 14.0992 15 13.6223 15 13.125V1.875C15 1.37772 14.8025 0.900806 14.4508 0.549175C14.0992 0.197544 13.6223 0 13.125 0ZM0.9375 3.61594C0.9375 3.1725 1.3575 2.8125 1.875 2.8125H13.125C13.6425 2.8125 14.0625 3.1725 14.0625 3.61594V13.2591C14.0625 13.7025 13.6425 14.0625 13.125 14.0625H1.875C1.3575 14.0625 0.9375 13.7025 0.9375 13.2591V3.61594Z"
            fill="black"
          />
          <path
            d="M6.09375 6.5625C6.34239 6.5625 6.58085 6.46373 6.75666 6.28791C6.93248 6.1121 7.03125 5.87364 7.03125 5.625C7.03125 5.37636 6.93248 5.1379 6.75666 4.96209C6.58085 4.78627 6.34239 4.6875 6.09375 4.6875C5.84511 4.6875 5.60665 4.78627 5.43084 4.96209C5.25502 5.1379 5.15625 5.37636 5.15625 5.625C5.15625 5.87364 5.25502 6.1121 5.43084 6.28791C5.60665 6.46373 5.84511 6.5625 6.09375 6.5625ZM8.90625 6.5625C9.15489 6.5625 9.39335 6.46373 9.56916 6.28791C9.74498 6.1121 9.84375 5.87364 9.84375 5.625C9.84375 5.37636 9.74498 5.1379 9.56916 4.96209C9.39335 4.78627 9.15489 4.6875 8.90625 4.6875C8.65761 4.6875 8.41915 4.78627 8.24334 4.96209C8.06752 5.1379 7.96875 5.37636 7.96875 5.625C7.96875 5.87364 8.06752 6.1121 8.24334 6.28791C8.41915 6.46373 8.65761 6.5625 8.90625 6.5625ZM11.7188 6.5625C11.9674 6.5625 12.2058 6.46373 12.3817 6.28791C12.5575 6.1121 12.6562 5.87364 12.6562 5.625C12.6562 5.37636 12.5575 5.1379 12.3817 4.96209C12.2058 4.78627 11.9674 4.6875 11.7188 4.6875C11.4701 4.6875 11.2317 4.78627 11.0558 4.96209C10.88 5.1379 10.7812 5.37636 10.7812 5.625C10.7812 5.87364 10.88 6.1121 11.0558 6.28791C11.2317 6.46373 11.4701 6.5625 11.7188 6.5625ZM3.28125 9.375C3.52989 9.375 3.76835 9.27623 3.94416 9.10041C4.11998 8.9246 4.21875 8.68614 4.21875 8.4375C4.21875 8.18886 4.11998 7.9504 3.94416 7.77459C3.76835 7.59877 3.52989 7.5 3.28125 7.5C3.03261 7.5 2.79415 7.59877 2.61834 7.77459C2.44252 7.9504 2.34375 8.18886 2.34375 8.4375C2.34375 8.68614 2.44252 8.9246 2.61834 9.10041C2.79415 9.27623 3.03261 9.375 3.28125 9.375ZM6.09375 9.375C6.34239 9.375 6.58085 9.27623 6.75666 9.10041C6.93248 8.9246 7.03125 8.68614 7.03125 8.4375C7.03125 8.18886 6.93248 7.9504 6.75666 7.77459C6.58085 7.59877 6.34239 7.5 6.09375 7.5C5.84511 7.5 5.60665 7.59877 5.43084 7.77459C5.25502 7.9504 5.15625 8.18886 5.15625 8.4375C5.15625 8.68614 5.25502 8.9246 5.43084 9.10041C5.60665 9.27623 5.84511 9.375 6.09375 9.375ZM8.90625 9.375C9.15489 9.375 9.39335 9.27623 9.56916 9.10041C9.74498 8.9246 9.84375 8.68614 9.84375 8.4375C9.84375 8.18886 9.74498 7.9504 9.56916 7.77459C9.39335 7.59877 9.15489 7.5 8.90625 7.5C8.65761 7.5 8.41915 7.59877 8.24334 7.77459C8.06752 7.9504 7.96875 8.18886 7.96875 8.4375C7.96875 8.68614 8.06752 8.9246 8.24334 9.10041C8.41915 9.27623 8.65761 9.375 8.90625 9.375ZM11.7188 9.375C11.9674 9.375 12.2058 9.27623 12.3817 9.10041C12.5575 8.9246 12.6562 8.68614 12.6562 8.4375C12.6562 8.18886 12.5575 7.9504 12.3817 7.77459C12.2058 7.59877 11.9674 7.5 11.7188 7.5C11.4701 7.5 11.2317 7.59877 11.0558 7.77459C10.88 7.9504 10.7812 8.18886 10.7812 8.4375C10.7812 8.68614 10.88 8.9246 11.0558 9.10041C11.2317 9.27623 11.4701 9.375 11.7188 9.375ZM3.28125 12.1875C3.52989 12.1875 3.76835 12.0887 3.94416 11.9129C4.11998 11.7371 4.21875 11.4986 4.21875 11.25C4.21875 11.0014 4.11998 10.7629 3.94416 10.5871C3.76835 10.4113 3.52989 10.3125 3.28125 10.3125C3.03261 10.3125 2.79415 10.4113 2.61834 10.5871C2.44252 10.7629 2.34375 11.0014 2.34375 11.25C2.34375 11.4986 2.44252 11.7371 2.61834 11.9129C2.79415 12.0887 3.03261 12.1875 3.28125 12.1875ZM6.09375 12.1875C6.34239 12.1875 6.58085 12.0887 6.75666 11.9129C6.93248 11.7371 7.03125 11.4986 7.03125 11.25C7.03125 11.0014 6.93248 10.7629 6.75666 10.5871C6.58085 10.4113 6.34239 10.3125 6.09375 10.3125C5.84511 10.3125 5.60665 10.4113 5.43084 10.5871C5.25502 10.7629 5.15625 11.0014 5.15625 11.25C5.15625 11.4986 5.25502 11.7371 5.43084 11.9129C5.60665 12.0887 5.84511 12.1875 6.09375 12.1875ZM8.90625 12.1875C9.15489 12.1875 9.39335 12.0887 9.56916 11.9129C9.74498 11.7371 9.84375 11.4986 9.84375 11.25C9.84375 11.0014 9.74498 10.7629 9.56916 10.5871C9.39335 10.4113 9.15489 10.3125 8.90625 10.3125C8.65761 10.3125 8.41915 10.4113 8.24334 10.5871C8.06752 10.7629 7.96875 11.0014 7.96875 11.25C7.96875 11.4986 8.06752 11.7371 8.24334 11.9129C8.41915 12.0887 8.65761 12.1875 8.90625 12.1875Z"
            fill="black"
          />
        </svg>
      </motion.div>

      <motion.div
        onClick={() => setUrl("/kit-details-lookup")}
        animate={path === "/kit-details-lookup" ? { x: 0 } : intital}
        whileHover={hover}
        // @ts-ignore

        transition={transtion}
        id="kit-details-lookup"
        className="cursor-pointer flex justify-around items-center h-12 rounded-r-full font-medium transition-colors ease-in-out duration-150 hover:bg-purple-200"
      >
        <p className="w-24 text-balance text-sm">Kit Details Lookup</p>
        <svg
          width="15"
          height="15"
          viewBox="0 0 15 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11.0086 9.69676C11.9163 8.45791 12.3229 6.92194 12.1469 5.39615C11.971 3.87036 11.2255 2.46727 10.0596 1.4676C8.89374 0.467925 7.39345 -0.0546141 5.8589 0.00452304C4.32436 0.0636602 2.86872 0.700112 1.78321 1.78655C0.697708 2.87298 0.0623867 4.32928 0.00435596 5.86409C-0.0536748 7.39889 0.469864 8.89902 1.47023 10.0643C2.4706 11.2297 3.87402 11.9743 5.39972 12.1491C6.92542 12.324 8.46088 11.9163 9.69891 11.0075H9.69798C9.72548 11.045 9.7561 11.081 9.78985 11.1153L13.3991 14.7251C13.5749 14.901 13.8133 14.9999 14.062 15C14.3107 15.0001 14.5492 14.9014 14.7251 14.7256C14.901 14.5498 14.9999 14.3113 15 14.0625C15.0001 13.8138 14.9014 13.5753 14.7256 13.3993L11.1164 9.78959C11.0829 9.75563 11.0468 9.72523 11.0086 9.69676ZM11.2504 6.09264C11.2504 6.76984 11.1171 7.44041 10.8579 8.06606C10.5988 8.69171 10.219 9.26019 9.74025 9.73904C9.26146 10.2179 8.69306 10.5977 8.0675 10.8569C7.44194 11.116 6.77147 11.2494 6.09436 11.2494C5.41726 11.2494 4.74679 11.116 4.12123 10.8569C3.49566 10.5977 2.92726 10.2179 2.44848 9.73904C1.9697 9.26019 1.5899 8.69171 1.33079 8.06606C1.07167 7.44041 0.938306 6.76984 0.938307 6.09264C0.938307 4.72498 1.48153 3.41333 2.44848 2.44625C3.41543 1.47916 4.72689 0.93586 6.09436 0.93586C7.46183 0.93586 8.7733 1.47916 9.74025 2.44625C10.7072 3.41333 11.2504 4.72498 11.2504 6.09264Z"
            fill="black"
          />
        </svg>
      </motion.div>

      <motion.div
        onClick={() => setUrl("/reports")}
        animate={path === "/reports" ? { x: 0 } : intital}
        whileHover={hover}
        // @ts-ignore

        transition={transtion}
        id="reports"
        className="cursor-pointer flex justify-around items-center h-12 rounded-r-full font-medium transition-colors ease-in-out duration-150 hover:bg-purple-200"
      >
        <p className="w-24 text-balance">Reports</p>
        <svg
          width="15"
          height="14"
          viewBox="0 0 15 14"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10.3125 1C10.3125 0.734784 10.4113 0.48043 10.5871 0.292893C10.7629 0.105357 11.0014 0 11.25 0H13.125C13.3736 0 13.6121 0.105357 13.7879 0.292893C13.9637 0.48043 14.0625 0.734784 14.0625 1V13H14.5312C14.6556 13 14.7748 13.0527 14.8627 13.1464C14.9506 13.2402 15 13.3674 15 13.5C15 13.6326 14.9506 13.7598 14.8627 13.8536C14.7748 13.9473 14.6556 14 14.5312 14H0.46875C0.34443 14 0.225201 13.9473 0.137294 13.8536C0.049386 13.7598 0 13.6326 0 13.5C0 13.3674 0.049386 13.2402 0.137294 13.1464C0.225201 13.0527 0.34443 13 0.46875 13H0.9375V10C0.9375 9.73478 1.03627 9.48043 1.21209 9.29289C1.3879 9.10536 1.62636 9 1.875 9H3.75C3.99864 9 4.2371 9.10536 4.41291 9.29289C4.58873 9.48043 4.6875 9.73478 4.6875 10V13H5.625V6C5.625 5.73478 5.72377 5.48043 5.89959 5.29289C6.0754 5.10536 6.31386 5 6.5625 5H8.4375C8.68614 5 8.9246 5.10536 9.10041 5.29289C9.27623 5.48043 9.375 5.73478 9.375 6V13H10.3125V1Z"
            fill="black"
          />
        </svg>
      </motion.div>
    </div>
  );
};

export default Nav;
